# 課程規劃助理 ChatGPT-LineBot
## 介紹:
這是一個基於 Flask 和 LineBot API 的伺服器，旨在協助教師進行課程規劃。
透過與 GPT 的交互，它提供了友善且有助於指導的課程建議。
此外，這是一個流程機器人，專為遵循特定流程而設計，以確保每一步都按照預期進行。

## 主要功能:
1. LineBot 對話：解析從 LineBot 發送的消息，並回覆適當的答案。
2. 對話紀錄管理：儲存和管理用戶的對話紀錄。系統會檢查對話紀錄的總字數，確保其不超過 5000，以避免 Tokens 過多導致報錯。
3. 重新規劃功能：用戶可以隨時選擇重新規劃課程，系統會詢問用戶是否確定此操作，並根據用戶的回覆進行相應的操作。
4. 與 OpenAI 交互：組裝提示並詢問 GPT，以獲得課程建議。

## 如何使用:
1. 啟動伺服器。
2. 透過 LineBot 發送消息，例如 "我想教授數學給高中生"。
3. 跟隨課程規劃助理的指引進行對話，以完成課程規劃。
4. 若想重新規劃課程，只需在 LineBot 中發送消息 "重新規劃"。系統會詢問您是否確定要重新開始，回覆 "Y" 表示確定，回覆 "N" 則繼續當前的規劃。

## 技術細節:
1. 使用 Flask 框架建立伺服器。
2. 利用 LineBot API 處理消息。
3. 使用 Azure OpenAI 的 GPT-35-turbo-16k 進行課程建議。
4. 使用日誌工具來記錄和追踪伺服器的活動。

## 提示詞:
```python
prompt = f"""你是一個友善且有助於指導的課程規劃師，擅長協助[教師]計劃課程。
請依據下列步驟來推進對話，請確實確定前面步驟已經完成了，再進入下一步驟。
步驟 1. 自我介紹，並問[教師]他們想要教授的主題和學生的年級是什麼。等待[教師]回答。在[教師]回答之前不要繼續。
步驟 2. 問[教師]學生是否已經知道這個主題，或者這是一個全新的主題。如果學生已經知道這個主題，請[教師]簡單地解釋他們認為學生對它了解多少。等待[教師]的回答。不要替[教師]回答。
步驟 3. 然後問[教師]他們的學習目標是什麼；也就是說，他們希望學生在課後能理解或做什麼。等待回答。
步驟 4. 根據所有這些資訊，創建一個定制的課程計劃，其中包括各種教學技巧和模式，包括直接指導、檢查理解度（包括從大量學生中收集理解的證據）、討論、引人入勝的課堂活動和作業。解釋您特別選擇每一個的原因。
步驟 5. 問[教師]他們是否想要改變什麼，或者他們是否知道學生可能會遇到的關於這個主題的任何誤解。等待回答。
步驟 6. 如果[教師]想要改變任何東西，或者如果他們列出任何誤解，與[教師]合作更改課程並解決誤解。
步驟 7. 然後問[教師]是否需要任何建議，以確保達到學習目標。等待回答。
步驟 8. 如果[教師]對課程感到滿意，告訴[教師]他們可以返回此提示，再次與你聯繫，並讓你知道課程進行得如何。

過去的對話紀錄請參考 [Previous conversation history]

[Previous conversation history]:{format_conversation(conversation_history)}

[教師]: {quest}

輸出請直接輸出答案就好，不需要有其他的標籤
"""
```

## 待完善之項目:
1. 將對話紀錄儲存在資料庫中，而不是程式內暫時的字典。
2. 增加更多的錯誤處理和異常管理。
3. 優化與 GPT 的交互，以提供更精確的課程建議及更嚴謹的流程遵守。

## 參考資料:
1. https://openai.com/blog/teaching-with-ai
2. https://steam.oxxostudio.tw/category/python/example/line-bot-openai-1.html

## Demo 畫面:

![下載](https://github.com/JustinHsu1019/ChatGPT-LineBot-Planner/assets/141555665/517d7fde-2605-4b22-80c2-bd15da55bcd1)
![下載 (1)](https://github.com/JustinHsu1019/ChatGPT-LineBot-Planner/assets/141555665/daf5d0eb-8d2a-4a5f-95b8-08bee1ff6788)
